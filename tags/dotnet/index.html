<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="generator" content="Hugo 0.58.2" />

  <title>dotnet &middot; DIYDeveloper.io</title>

  
  <link rel="stylesheet" href="/css/bootstrap-social.css">
  <link rel="stylesheet" href="/css/blog.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Vollkorn" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700" rel="stylesheet" type="text/css">

  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />

  <link href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700,700i,900,900i|Fira+Sans:400,400i,700,700i,900,900i|Quicksand:300,400,500,700" rel="stylesheet" />
  <link href="/css/prism.css" rel="stylesheet" />
  <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src='/js/prism.js' type='text/javascript'></script>
  <script src='//cdnjs.cloudflare.com/ajax/libs/stackblur-canvas/1.4.0/stackblur.min.js' type='text/javascript'></script>


  
  <link rel="stylesheet" href="/css/jquery.fancybox.css?v=2.1.5" type="text/css" media="screen" />
  <script type="text/javascript" src="/js/jquery.fancybox.pack.js?v=2.1.5"></script>
  <script type='text/javascript'>
   $(document).ready(function() {
      $(".fancybox").fancybox({
      helpers : {
          title: {
              type: 'inside',
              position: 'top'
          }
      },
      nextEffect: 'fade',
      prevEffect: 'fade'});
   });
  </script>

</head>


<body>

<header id="page-header">
    <div class="header title-header">
        <h1><a href="/">DIY Developer</a></h1>
        <h2>Power tools, software, 3d printing</h2>
    </div>
</header>

<section class="content">
  <div class="pure-g post-index">
    <div class="pure-u-1">
      <div class="title-center">
          <h1><i class="fa fa-tags fa-fw"></i> dotnet</h1>
      </div>
    </div>
    
    <article class="blog-post">
    <div class="post-header">
        <h2><a href="/tech/2014/12/15/csharp6-new-features/">3 Awesome New C# Features</a></h2>
    </div>
    <div class="post-meta">

  
  

  
     
      
      
      
    
  
  <div class="article-meta">
      
      <div class="social-buttons"> 
            <a class="btn btn-social-icon btn-twitter" href="http://twitter.com/share?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2014%2f12%2f15%2fcsharp6-new-features%2f&amp;text=3%20Awesome%20New%20C%23%20Features&amp;via=dfrencham"><i class="fa fa-twitter"></i></a>
            <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdiydeveloper.io%2ftech%2f2014%2f12%2f15%2fcsharp6-new-features%2f&amp;t=3%20Awesome%20New%20C%23%20Features"><i class="fa fa-facebook"></i></a>
            <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2014%2f12%2f15%2fcsharp6-new-features%2f"><i class="fa fa-linkedin"></i></a>  
            <a class="btn btn-social-icon btn-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2014%2f12%2f15%2fcsharp6-new-features%2f&title=3%20Awesome%20New%20C%23%20Features"><i class="fa fa-reddit"></i></a>      
     </div>
     <div class="tags">
          <div class="taxonomy-tag">             
              <i class="fa fa-calendar fa-fw"></i>            
              <time>15 Dec 2014</time> 
          </div>
          
            
            
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/dotnet">dotnet</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/programming">programming</a>
                </div>
              
            
          
      </div>
      
  </div>

</div>
    <p>A new version of C# is on the way. Here are 3 new features to make your life easier.</p>

<p>New additions in C# 6 are focused on making developers more productive - getting more done with less code. Let&rsquo;s start with a nice new operator.</p>

<h2 id="null-propogation-operator">Null Propogation Operator</h2>

<p>Most C# devs will be familiar with this sort of code:</p>

<pre class="line-numbers"><code class="language-csharp">
if (businessThing != null) && (businessThing.OtherThing != null) {
  if (businessThing.OtherThing.NestedThing != null) {
    businessThing.OtherThing.NestedThing.DoThings();
  }
}
</code></pre>

<p>A common repetitive task is to check that an object is not null, and if it is not null, do somthing with one of the objects properties.</p>

<p>Now we have this shiny new operator:</p>

<div style="font-size:72px">?.</div>

<p>This is the null propation operator. It does a null check of a property, and if that null check passes, it then accesses the property. If the null check doesn&rsquo;t pass, it jumps out of the statement and continues program execution without throwing an exception.</p>

<p>Our ugly block of code above, becomes this:</p>

<pre class="line-numbers"><code class="language-csharp">businessThing?.OtherThing?.NestedThing.DoThings();</code></pre>

<p>It really improves readability, as well as making your code more consise.</p>

<h2 id="nameof-expression">Nameof Expression</h2>

<p>This tells us the name of a variable. Here&rsquo;s a use case:</p>

<pre class="line-numbers"><code class="language-csharp">
public void PrintFavourites(string animal, string food) {
  // using nameof
  if (animal == null)
    throw new ArgumentNullException(nameof(animal));

  // using magic strings, bad
  if (food == null)
    throw new ArgumentNullException("food");

  // do stuff
}  
</code></pre>

<p>Cool huh?</p>

<h2 id="auto-property-initialisers">Auto Property Initialisers</h2>

<p>Auto properties are great, but up until now we can&rsquo;t auto initialise them, which is less than great for a read only property. Currently we need to:</p>

<ol>
<li>Create backing field</li>
<li>Initialise the backing field in our constructor</li>
<li>Explicitly create the property, referencing the backing field</li>
</ol>

<p>C#6 brings us auto property initialisers, allowing declaration and initialisation in a single line:</p>

<pre class="line-numbers"><code class="language-csharp">public string Bob { get; } = "Dave";</code></pre>

<p>Bam. Done.</p>

<h2 id="how-long-do-i-have-to-wait">How long do I have to wait?!?!</h2>

<p>C#6 will be shipping with VS2015, which recently had the developer preview released. The release date isn&rsquo;t finalised yet.</p>

<p>You can get more details on C#6 <a href="http://msdn.microsoft.com/en-us/magazine/dn802602.aspx">here</a>, and more detail on VS2015 <a href="http://www.visualstudio.com/en-us/news/vs2015-preview-vs.aspx">here</a>.</p>
    <p>/eof</p>
</article>
    
    <article class="blog-post">
    <div class="post-header">
        <h2><a href="/tech/2013/12/18/auto-mocking-with-automoq/">Auto mocking with AutoMoq</a></h2>
    </div>
    <div class="post-meta">

  
  

  
     
      
      
      
    
  
  <div class="article-meta">
      
      <div class="social-buttons"> 
            <a class="btn btn-social-icon btn-twitter" href="http://twitter.com/share?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f12%2f18%2fauto-mocking-with-automoq%2f&amp;text=Auto%20mocking%20with%20AutoMoq&amp;via=dfrencham"><i class="fa fa-twitter"></i></a>
            <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f12%2f18%2fauto-mocking-with-automoq%2f&amp;t=Auto%20mocking%20with%20AutoMoq"><i class="fa fa-facebook"></i></a>
            <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f12%2f18%2fauto-mocking-with-automoq%2f"><i class="fa fa-linkedin"></i></a>  
            <a class="btn btn-social-icon btn-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f12%2f18%2fauto-mocking-with-automoq%2f&title=Auto%20mocking%20with%20AutoMoq"><i class="fa fa-reddit"></i></a>      
     </div>
     <div class="tags">
          <div class="taxonomy-tag">             
              <i class="fa fa-calendar fa-fw"></i>            
              <time>18 Dec 2013</time> 
          </div>
          
            
            
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/development">development</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/testing">testing</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/C">C#</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/dotnet">dotnet</a>
                </div>
              
            
          
      </div>
      
  </div>

</div>
    <p>AutoMoq is a nice little package I came across today. The AutoMoq home page describes it as follows:</p>

<blockquote>AutoMoq is an &quot;auto-mocking&quot; container that creates objects for you. Just tell it what class to create and it will create it.</blockquote>

<p>Why is this useful? Consider the following scenario. We have a BananaCakeFactory class, that relies on a Banana Repository.</p>

<p>Here is the constructor:</p>

<pre class="line-numbers"><code class="language-csharp">
public BananaCakeFactory(IBananaRepo bananaRepo);
</code></pre>

<p>If we want to run Unit Tests on methods in BananaCakeFactory, we will have to write all the mocking code to mock IBananaRepo. That&rsquo;s fine.</p>

<p>Time goes on, our app grows more complex. Now our BananaCakeFactory needs to Sugar Repo as well&hellip;</p>

<pre class="line-numbers"><code class="language-csharp">
public BananaCakeFactory(IBananaRepo bananaRepo, ISugarRepo sugarRepo);
</code></pre>

<p>We add mocks for our Sugar Repo, and update all our constructor calls for BananaCakeFactory. When we have a large solution, time spent adding new mocks and updating constructors really adds up. AutoMoq can take the pain away.</p>

<p>Here is an example of how we use AutoMoq to create a mocked class, ready for testing:</p>

<pre class="line-numbers"><code class="language-csharp">
// init
mocker = new AutoMoqer();

// mock a Banana Cake Factory
var cakeFac = mocker.Create&lt;BananaCakeFactory&gt;();

// inject our IRepo
mocker.GetMock&lt;IBananaRepo&gt;();

// do work
var result = cakeFac.Bake();
</code></pre>

<p>Now if we want to add our Sugar Repo, all that&rsquo;s needed is the following additional line:</p>

<pre class="line-numbers"><code class="language-csharp">
mocker.GetMock&lt;ISugarRepo&gt;();
</code></pre>

<p>Happy Coding!</p>

<p><h2>Reference URLs</h2>
<li><a href="https://github.com/darrencauthon/AutoMoq">AutoMoq Homepage</a></li>
<li><a href="http://www.nuget.org/packages/AutoMoq/">AutoMoq Nuget Package</a></li></p>
    <p>/eof</p>
</article>
    
    <article class="blog-post">
    <div class="post-header">
        <h2><a href="/tech/2013/07/18/nested-dependencies-in-mvc4/">Nested Dependencies in MVC4</a></h2>
    </div>
    <div class="post-meta">

  
  

  
     
      
      
      
    
  
  <div class="article-meta">
      
      <div class="social-buttons"> 
            <a class="btn btn-social-icon btn-twitter" href="http://twitter.com/share?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f07%2f18%2fnested-dependencies-in-mvc4%2f&amp;text=Nested%20Dependencies%20in%20MVC4&amp;via=dfrencham"><i class="fa fa-twitter"></i></a>
            <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/sharer.php?u=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f07%2f18%2fnested-dependencies-in-mvc4%2f&amp;t=Nested%20Dependencies%20in%20MVC4"><i class="fa fa-facebook"></i></a>
            <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f07%2f18%2fnested-dependencies-in-mvc4%2f"><i class="fa fa-linkedin"></i></a>  
            <a class="btn btn-social-icon btn-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fdiydeveloper.io%2ftech%2f2013%2f07%2f18%2fnested-dependencies-in-mvc4%2f&title=Nested%20Dependencies%20in%20MVC4"><i class="fa fa-reddit"></i></a>      
     </div>
     <div class="tags">
          <div class="taxonomy-tag">             
              <i class="fa fa-calendar fa-fw"></i>            
              <time>18 Jul 2013</time> 
          </div>
          
            
            
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/MVC4">MVC4</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/development">development</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/C">C#</a>
                </div>
              
                <div class="taxonomy-tag">             
                    <i class="fa fa-tags fa-fw"></i>            
                    <a class="post-taxonomy-tag" href="https://diydeveloper.iotags/dotnet">dotnet</a>
                </div>
              
            
          
      </div>
      
  </div>

</div>
    <p>Given how complex the average MVC4 application can become, it is likely that you are going to come across the situation where you build up a dependency chain. It may look like this: Controller -&gt; Provider/Manager -&gt; Dependency<br /></p>

<p>&nbsp;A common scenario may be that your controller needs a Lookup Manager, and that manager needs a cached query passed in.</p>

<p>In this scenario, the Unity.Mvc4 nuGet package comes into play.</p>

<p>Here is our home controller:</p>

<pre class="line-numbers"><code class="language-csharp">
// Home controller
public class HomeController : AsyncController
{
    private ILookupManager&lt;StatusLookup&gt; statusLookup;

    // constructor with lookup dependency
    public HomeController(ILookupManager&lt;StatusLookup&gt; statusLookup)
    {
        this.statusLookup = statusLookup;
    }
}
</code></pre>

<p>Notice that the constructor requires the StatusLookup.</p>

<p>Here is the Status Manager implementation. Observe that it is a generic class, expecting a StatusLookup object. The constructor requires a query passed in (of type IQuery).</p>

<pre class="line-numbers"><code class="language-csharp">
//LookupManager.cs
public class LookupManager&lt;T&gt; : ILookupManager&lt;T&gt; where T : ILookupField
{
    private IQuery&lt;T&gt; _query;

    // lookup manager has a Query dependency
    public LookupManager(IQuery&lt;T&gt; query)
    {
        _query = query;
    }

    public List&lt;T&gt; Lookup()
    {
        // return lookup query result
        return _query.Get();
    }
}
</code></pre>

<p>This is where life gets easy. After installing the Unity.Mvc4 nuGet package, our MVC project gains a &ldquo;boostrapper&rdquo; class.&nbsp;This provides us with a simple mechanism to get any dependency into any class in our MVC app. It works by utilising the Unity&nbsp;Dependency Injection container.</p>

<pre class="line-numbers"><code class="language-csharp">
// Boostrapper.cs
// Added by the Unity.Mvc4 NuGet package
private static IUnityContainer BuildUnityContainer()
{
    var container = new UnityContainer();

    // initialise Status lookup
    container.RegisterType&lt;IQuery&lt;StatusLookup&gt;, QueryStatusLookup&gt;();

    // make Status lookup available to mvc4 controllers
    container.RegisterType&lt;ILookupManager&lt;StatusLookup&gt;, LookupManager&lt;StatusLookup&gt;&gt;();

    RegisterTypes(container);
    return container;
}
</code></pre>

<p>If we have a look at the BuildUnityContainer() method, there are two calls to container.RegisterType(). The first is to provide the IQuery dependency to StatusLookup. The second is to provide the StatusLookup dependency to our HomeController.</p>

<p>To keep it all manageable, make sure your dependencies are passed using an interface (ILookupManager, and IQuery in my case).</p>
    <p>/eof</p>
</article>
    
  </div>
</div>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48772536-1', 'auto');
  ga('send', 'pageview');

</script>



<footer class="page-footer">
    <div class="pure-menu">
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1-2">
            
              <a class="icon-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
            
              <a class="icon-link" href="/archive/"><i class='fa fa-list fa-fw'></i>Archive</a>
            
              <a class="icon-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
            
            <a class="icon-link" href="https://github.com/dfrencham" target="_blank"><i class="fa fa-github-square fa-fw"></i>GitHub</a>
    
        </div>
        <div class="pure-u-1 pure-u-md-1-2 pure-u-lg-1-2">
            <div>
  <div class="small-print">
    <small></small>
  </div>
  <div class="small-print">
    <small>
      Built with <a href="https://gohugo.io/" target="_blank">Hugo</a>
    </small>
  </div>
</div>

        </div>
    </div>
</footer>
</body>
</html>
